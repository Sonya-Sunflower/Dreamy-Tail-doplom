import{a as u,c as d,d as l,b as m,e as c}from"./script-Df4MtpFW.js";import{J as I}from"./just-validate.es-C73wyOde.js";import{I as p}from"./inputmask-CsGDK5Eu.js";class h{emailInputId;passwordInputId;nameInputId;surnameInputId;phoneInputId;constructor(e,r,a,s,t){this.emailInputId=e,this.passwordInputId=r,this.nameInputId=a,this.surnameInputId=s,this.phoneInputId=t}getElementById(e){const r=document.getElementById(e);if(!r)throw new Error(`Element with id "${e}" not found.`);return r}async saveUserToDatabase(e,r,a,s,t,o){await u(d(l,"users"),{uid:e,role:r,email:a,name:s,surname:t,phone:o}),document.cookie=`UID=${e}`}async createAccount(){const e=this.getElementById(this.emailInputId).value,r=this.getElementById(this.passwordInputId).value,a=this.getElementById(this.nameInputId).value,s=this.getElementById(this.surnameInputId).value,t=this.getElementById(this.phoneInputId).value;try{const i=(await m(c,e,r)).user.uid;await this.saveUserToDatabase(i,"user",e,a,s,t),window.location.href="/Dreamy-Tail-doplom/cabinet-user.html?tab=%23main-info"}catch(o){console.error("There was an error:",o),this.showLoginError(o)}}showLoginError(e){console.error("Login error:",e)}}class g{formId;validator;constructor(e){this.formId=e,this.validator=new I(this.formId),this.applyMasks(),this.initializeValidation()}applyMasks(){p({mask:"+99 (999) 999 99 99",placeholder:" "}).mask(document.querySelector("#tel"))}initializeValidation(){this.validator.addField("#name",[{rule:"required",errorMessage:"Ведіть iм'я"},{rule:"minLength",value:2,errorMessage:"Iм'я має містити більше символів"},{rule:"customRegexp",value:/^[А-Яа-яЁёІіЇїЄєҐґA-Za-z]{2,}$/,errorMessage:"Iм'я має містити лише літери"}]).addField("#surname",[{rule:"required",errorMessage:"Ведіть прізвище"},{rule:"minLength",value:2,errorMessage:"Прізвище має містити більше символів"},{rule:"customRegexp",value:/^[А-Яа-яЁёІіЇїЄєҐґA-Za-z]{2,}$/,errorMessage:"Прізвище має містити лише літери"}]).addField("#email",[{rule:"required",errorMessage:"Ведіть пошту"},{rule:"customRegexp",value:/^[-\w.]+@([а-яёa-z0-9][-A-z0-9]+\.)+[A-z]{2,4}$/,errorMessage:"Напишіть правильну пошту"}]).addField("#tel",[{rule:"required",errorMessage:"Ведіть номер телефону"}]).addField("#password",[{rule:"required",errorMessage:"Ведіть пароль"},{rule:"minLength",value:6,errorMessage:"Довжина не менше 6 символів"},{rule:"customRegexp",value:/[a-z]/,errorMessage:"Пароль повинен мати тільки англійські літери"},{rule:"customRegexp",value:/[A-Z]/,errorMessage:"Пароль повинен містити велику літеру"},{rule:"customRegexp",value:/[0-9]/,errorMessage:"Пароль повинен містити цифру"}]).onSuccess(e=>{e.preventDefault(),new h("email","password","name","surname","tel").createAccount()})}}document.addEventListener("DOMContentLoaded",async()=>{new g("#form-reg")});
