import{f as c,c as u,h as d,d as r,u as h}from"./script-Df4MtpFW.js";import{J as m}from"./just-validate.es-C73wyOde.js";import{I as f}from"./inputmask-CsGDK5Eu.js";import{P as p}from"./pop-up-Cl5BhUHu.js";class U{currentUser;uid;formId;validator;btn;constructor(t){this.uid=this.getCookie("UID"),this.formId=t,this.validator=new m(this.formId),this.btn=document.querySelector(".main-info__edit-info"),this.init()}init(){this.btn.addEventListener("click",()=>{new p(".pop-up-info"),this.applyMasks(),this.initializeValidation()})}getCookie(t){const s=`; ${document.cookie}`.split(`; ${t}=`);if(s.length===2)return s.pop()?.split(";").shift()}async fetchUsers(){const t=await c(u(r,"users")),e=[];t.forEach(a=>{e.push({uid:a.data().uid,id:a.id})});const s=e.find(a=>a.uid===this.uid);this.currentUser=s}async updateData(){const t=document.querySelector("#name"),e=document.querySelector("#surname"),s=document.querySelector("#tel");if(!t||!e||!s){console.error("One or more input elements are not found in the DOM");return}const a=t.value,i=e.value,l=s.value;if(!this.uid){console.error("UID not found");return}try{if(!this.currentUser?.id){console.error("Current user ID is undefined.");return}const n=d(r,"users",this.currentUser?.id);await h(n,{name:a,surname:i,phone:l})}catch(n){console.error(n)}}applyMasks(){f({mask:"+99 (999) 999 99 99",placeholder:" "}).mask(document.querySelector("#tel"))}initializeValidation(){this.validator.addField("#name",[{rule:"required",errorMessage:"Ведіть iм'я"},{rule:"minLength",value:2,errorMessage:"Iм'я має містити більше символів"},{rule:"customRegexp",value:/^[А-Яа-яЁёІіЇїЄєҐґA-Za-z]{2,}$/,errorMessage:"Iм'я має містити лише літери"}]).addField("#surname",[{rule:"required",errorMessage:"Ведіть прізвище"},{rule:"minLength",value:2,errorMessage:"Прізвище має містити більше символів"},{rule:"customRegexp",value:/^[А-Яа-яЁёІіЇїЄєҐґA-Za-z]{2,}$/,errorMessage:"Прізвище має містити лише літери"}]).addField("#tel",[{rule:"required",errorMessage:"Ведіть номер телефону"}]).onSuccess(t=>{t.preventDefault(),this.fetchUsers().then(()=>{this.updateData().then(()=>{location.reload()})})})}}class S{mainInfoContent;uid;currentUser;constructor(){this.mainInfoContent=document.querySelector(".main-info__content"),this.uid=this.getCookie("UID"),this.init()}init(){this.fetchUsers().then(()=>{this.showInfo()})}getCookie(t){const s=`; ${document.cookie}`.split(`; ${t}=`);if(s.length===2)return s.pop()?.split(";").shift()}async fetchUsers(){const t=await c(u(r,"users")),e=[];t.forEach(a=>{e.push({uid:a.data().uid,name:a.data().name,surname:a.data().surname,phone:a.data().phone,email:a.data().email})});const s=e.find(a=>a.uid===this.uid);this.currentUser=s}async showInfo(){if(this.mainInfoContent){const t=this.mainInfoContent.querySelector(".name__db");t&&(t.textContent=this.currentUser?.name??"");const e=this.mainInfoContent.querySelector(".surname__db");e&&(e.textContent=this.currentUser?.surname??"");const s=this.mainInfoContent.querySelector(".phone__db");s&&(s.textContent=this.currentUser?.phone??"");const a=this.mainInfoContent.querySelector(".email__db");a&&(a.textContent=this.currentUser?.email??"")}}}class y{tabsBtn;tabsItems;constructor(t,e){this.tabsBtn=document.querySelectorAll(t),this.tabsItems=document.querySelectorAll(e),this.init()}init(){this.tabsBtn.forEach(e=>{e.addEventListener("click",()=>this.onTabClick(e))}),this.loadActiveTab();const t=this.tabsBtn[0];t&&!localStorage.getItem("activeTab")&&t.click(),this.updateTabFromURL()}onTabClick(t){const e=t.getAttribute("data-tab"),s=e?document.querySelector(e):null;if(!s){console.error(`Tab with ID "${e}" not found.`);return}t.classList.contains("active")||(this.resetActiveStates(),t.classList.add("active"),s.classList.add("active"),this.updateURL(e),e&&this.saveActiveTab(e))}resetActiveStates(){this.tabsBtn.forEach(t=>t.classList.remove("active")),this.tabsItems.forEach(t=>t.classList.remove("active"))}updateURL(t){if(t){const e=new URL(window.location.href);e.searchParams.set("tab",t),history.pushState(null,"",e.toString())}}updateTabFromURL(){const e=new URLSearchParams(window.location.search).get("tab");if(e){const s=Array.from(this.tabsBtn).find(i=>i.getAttribute("data-tab")===e),a=s?document.querySelector(e):null;s&&a&&(this.resetActiveStates(),s.classList.add("active"),a.classList.add("active"),this.saveActiveTab(e))}}saveActiveTab(t){localStorage.setItem("activeTab",t)}loadActiveTab(){const t=localStorage.getItem("activeTab");if(t){const e=Array.from(this.tabsBtn).find(a=>a.getAttribute("data-tab")===t),s=e?document.querySelector(t):null;e&&s&&(this.resetActiveStates(),e.classList.add("active"),s.classList.add("active"))}}}export{U as E,S as M,y as T};
